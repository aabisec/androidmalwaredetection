# Static Analysis based Android Malware Detection System 
Android users and developers are known to make mistakes that expose them to unnecessary dangers
and risks of infecting their devices with malware. Android Malware Detection System is used to
analyze the mobile application and classify them as malware or benign. Static analysis is performed by
analyzing Android files and extracting information like requested permissions, opcode sequences, and
API calls, etc. Static detection is widely used in the field of Android malware detection for many
optional features that is easy to extract. There are multiple detection method that are being used to
detect malware in android apps. We are using machine learning for this purpose.

# Data
Androzoo dataset is used for this project. Androzoo dataset is consist of millions of apks labeled
whether apks is malicious or not. For this project, I just picked apks from 2022. The apks are picked
randomly from each month. There is 946 benign apps apks and 979 malicious apps apks. For benign
apks I have selected vt_detection parameter equal to zero (0) and for malicious, vt_detection
parameter greater than or equal to 5 is selected. This led to dataset of total 1925 apps. Only 1925 apps
are selected for this project because of computation power needed to download the apks and
extracting features is higher compared to computational power of the system. I made separate excel
files for benign and malicious apks I will download. Then using sha256 values in the file I downloaded
the apks in respective folders.

# Feature Extraction
During the literature review, I came cross features used for static android malware detections are the
permissions and the API calls. For this project, I am using permission as the feature. For extraction of
permissions from the apks I have downloaded I am using python library androguard and saved them
in text files in respective permissions folder.

Manifest files have different kinds of permission most are related to android. For that you will get
android.permissions in the prefix. Some permissions are vendor specific. So, I sorted the permissions,
I saved android based permissions of both benign and malicious apks in text files. For permissions, I
tried combining unique android permissions from both benign and malicious apps, and only android
permissions from malicious apps. I separately trained the model on both. Results were better with
only malicious app permissions as features.

# Dataset Creation
After setting the features, I made data frame using pandas library. I set selected permission as the
column with an additional column named class. Then I iterate the permission text files of each apk,
place them in an array. If an app have that permission, it will be marked as 1 otherwise 0. Benign apps
are marked as B and Malicious apps are marked as M in dataset. Then, we add it to data frame. After
finishing all the apks data frame is converted to csv file.

# Model Training
It is a classification problem, we are basically classifying the data in two groups, benign (0) or malware
(1). We are using supervised learning. The training data labeled with the category is the input into
machine learning models in supervised learning. I tried following model and algorithm for detection
of malware:
* Support Vector Machine
* Random Forest
* Decision Tree
* Logistic Regression

These models are used for classification problems. Further, they will be selected on the basis of metrics
calculation (accuracy, confusion matrix, precision, recall, f1 score).
The data is divided in two parts, training data and testing data. After this, model is also tested on
external data, apks are picked from csv file that not included in main dataset to check the model on
external data.
After looking at metrics on both testing data and external data, decision tree algorithm provided the
best results in terms of precision and recall. SVM model also performed well in test data and slightly
less better in external data than decision tree algorithm.
